name: Build, push and update lambda images for flood baseline and rcp 8.5

on:
  push:
    paths:
      - 'src/api/flood/**'
      - 'src/api/common/**'
      - '.github/workflows/flood.yml'
      - '.github/workflows/build-test-deploy.yml'
      - '.github/actions/build-push-layout/action.yml'
    branches: [ "main" ]

permissions:
  id-token: write
  contents: read

jobs:
  flood85-build-push:
    uses: ./.github/workflows/build-test-deploy.yml
    with:
      aws-role-name: gh_flood
      aws-account-id: 600920596656
      aws-region: eu-central-1
      geotiff-keyword: GEOTIFF_PATH_RCP85
      risk-folder: flood
      image-name: apinine_flood_rcp85
      lambda-name: apinine_flood_rcp85

  floodbase-build-push:
    uses: ./.github/workflows/build-test-deploy.yml
    with:
      aws-role-name: gh_flood
      aws-account-id: 600920596656
      aws-region: eu-central-1
      geotiff-keyword: GEOTIFF_PATH
      risk-folder: flood
      image-name: apinine_flood
      lambda-name: apinine_flood
